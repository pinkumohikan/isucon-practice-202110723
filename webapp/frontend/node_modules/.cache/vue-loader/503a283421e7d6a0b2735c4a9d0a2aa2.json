{"remainingRequest":"/opt/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/opt/frontend/src/views/Payment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/opt/frontend/src/views/Payment.vue","mtime":1621475513321},{"path":"/opt/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/opt/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/opt/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Router from '@/router.js'\nimport { apiService } from '../services/api.js'\nimport ReservationDetail from '@/components/Reservation/ReservationDetail.vue'\n\nexport default {\n  components: {ReservationDetail},\n  data: function() {\n    return {\n      reservation_id: 0,\n      reservation: null,\n      card_number: \"\",\n      cvv: \"\",\n      expiry_date_month: \"01\",\n      expiry_date_year: \"24\"\n    }\n  },\n  computed: {\n    year() { return this.reservation.date.getYear() + 1900},\n    month() { return this.reservation.date.getMonth() + 1 },\n    day() { return this.reservation.date.getDate() },\n    expiry_date() { return this.expiry_date_month + \"/\" + this.expiry_date_year },\n    arrival_time() {\n      return new Date(\"2020-01-01 \" + this.reservation.arrival_time)\n    },\n    departure_time() {\n      return new Date(\"2020-01-01 \" + this.reservation.departure_time)\n    },\n    seat_class_name () {\n      var m = {\n        premium: \"プレミアム\",\n        reserved: \"普通席\",\n        \"non-reserved\": \"自由席\",\n        \"\": \"\",\n      }\n      return m[this.reservation.seat_class]\n    },\n  },\n  methods: {\n    getReservation() {\n      apiService.getReservation(this.reservation_id).then((res) => {\n        this.reservation = res\n        console.log(res)\n      })\n    },\n    payment() {\n    var data = {\n      card_number: this.card_number,\n      cvv: this.cvv,\n      expiry_date: this.expiry_date,\n    }\n\n    apiService.tokenizeCard(data).then((res) => {\n      console.log(\"OK\")\n      console.log(res)\n      var card_token = res.card_token\n\n      var data = {\n        \"reservation_id\": this.reservation_id,\n        \"card_token\": card_token,\n      }\n      apiService.commit(data).then((res) => {\n        Router.push({path: \"/\"})\n      })\n    })\n\n    }\n  },\n  mounted() {\n    this.reservation_id = parseInt(this.$route.query.reservation_id);\n    return this.getReservation();\n  }\n}\n",null]}